const MEMMOVE_CALL_LOC_ieee802154_reassemble = 0x00403c3d;

pub fn main(api) {
    // CVE check
    api.on_basic_block(Some(symbolizer::resolve("memmove")?), |_| on_CVE_2021_3321());
}

fn on_CVE_2021_3321() {
    // Check for size underflow in memmove call from ieee802154_reassemble
    if register::read("R2")? > 0xf0000000 && register::read("LR")? == MEMMOVE_CALL_LOC_ieee802154_reassemble {
        input::add_bug("CVE-2021-3321");
    }
}