pub fn main(api) {
    // CVE check
    api.on_basic_block(Some(symbolizer::resolve("net_6lo_uncompress")?), |_| on_CVE_2021_3322());
}

fn on_CVE_2021_3322() {
    // Check for NULL ptr in pkt->frags
    let pkt = register::read("R0")?;
    let frags = memory::read_u32(pkt + 0x10)?;

    if frags == 0 {
        input::add_bug("CVE-2021-3322");
    }
}