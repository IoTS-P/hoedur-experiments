pub fn main(api) {
    api.on_basic_block(Some(symbolizer::resolve("gnrc_rpl_srh_process")?), gnrc_rpl_srh_process);
}

fn gnrc_rpl_srh_process(pc) {
    let rh = register::read("R1")?;
    let len = memory::read_u8(rh + 1)?;
    let compre = memory::read_u8(rh + 4)? & 0x0F;
    let padding = memory::read_u8(rh + 5)? >> 4;

    if (len * 8 < padding + (16 - compre)) {
        input::add_bug("new-Bug-CVE-2023-24817");
    }
}
