// PORTING: Hook add instruction in _iphc_encode, incrementing the dispach_size by 8
const HOOKED_ADDR = 0x20f150;

pub fn main(api) {
    api.on_instruction(Some(HOOKED_ADDR), on_CVE);
}

fn on_CVE(pc) {
    // PORTING: Ensure variable register assignment
    let snippet = register::read("R3")?;
    let size = memory::read_u32(snippet + 8)?;
    if size > 8 {
        // actuall snippet size is larger than the udp header
        input::add_bug("new-Bug-CVE-2023-24823");
    }
}

