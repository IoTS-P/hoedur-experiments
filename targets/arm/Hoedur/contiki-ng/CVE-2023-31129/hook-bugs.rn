// Check the return value of uip_ds6_nbr_add in rs_input
// PORTING: Ensure the correct offset
const HOOKED_ADDR = 0x207d9c;

pub fn main(api) {
    // CVE check
    api.on_basic_block(Some(HOOKED_ADDR), on_CVE);
}

fn on_CVE(pc) {
    // Check for NULL pointer condition of return value
    if register::read("R0")? == 0 {
        input::add_bug("new-Bug-CVE-2023-31129");
    }
}
