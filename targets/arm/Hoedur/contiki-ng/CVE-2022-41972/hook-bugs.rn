// PORTING: Hook just before write access in input_l2cap_credit to
//          channel_for_addr->channel_peer.credits. E.g., 3rd memcpy return.
const HOOKED_ADDR = 0x20b350;

pub fn main(api) {
    // CVE check
    api.on_basic_block(Some(HOOKED_ADDR), |_| on_CVE());
}

fn on_CVE() {
    // PORTING: Ensure variable channel register assignment
    let channel = register::read("R5")?;

    if channel == 0 {
        input::add_bug("new-Bug-CVE-2022-41972");
    }
}
