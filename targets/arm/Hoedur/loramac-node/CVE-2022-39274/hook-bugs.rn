// in ProcessRadioRxDone check is the size is 0 before memcpy is called with size - 1
const HOOKED_ADDR = 0x08006c62;

pub fn main(api) {
    // CVE check
    api.on_basic_block(Some(HOOKED_ADDR), on_CVE);
}

fn on_CVE(pc) {
    let size = register::read("r6")?;

    if size == 0 {
        input::add_bug("new-Bug-CVE-2022-39274");
    }
}
