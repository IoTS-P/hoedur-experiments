# Missing `ipv6` nullptr-check in `handle_ra_input`

## Summary

A missing nullptr-check in `handle_ra_input` can cause a nullptr-deref.

## Description

The `reachable_time` update in `handle_ra_input` is missing a nullptr-check for `net_pkt_iface(pkt)->config.ip.ipv6` before calling `net_if_ipv6_set_reachable_time`:

```c
if (reachable_time && reachable_time <= MAX_REACHABLE_TIME && (net_if_ipv6_get_reachable_time(net_pkt_iface(pkt)) != reachable_time)) {
    net_if_ipv6_set_base_reachable_time(net_pkt_iface(pkt), reachable_time);
    net_if_ipv6_set_reachable_time(net_pkt_iface(pkt)->config.ip.ipv6);
}
```

https://github.com/zephyrproject-rtos/zephyr/blob/98580f1c22481c200db2f37881e9c5161f2bd35f/subsys/net/ip/ipv6_nbr.c#L2377-L2384

The `ipv6` interface pointer is passed into `net_if_ipv6_calc_reachable_time` in `net_if_ipv6_set_reachable_time`:

```c
ipv6->reachable_time = net_if_ipv6_calc_reachable_time(ipv6);
```

https://github.com/zephyrproject-rtos/zephyr/blob/98580f1c22481c200db2f37881e9c5161f2bd35f/include/zephyr/net/net_if.h#L1424-L1435

The `ipv6` interface pointer is then used without an additional check in `net_if_ipv6_calc_reachable_time`:

```c
min_reachable = (MIN_RANDOM_NUMER * ipv6->base_reachable_time) / MIN_RANDOM_DENOM;
max_reachable = (MAX_RANDOM_NUMER * ipv6->base_reachable_time) / MAX_RANDOM_DENOM;
```

https://github.com/zephyrproject-rtos/zephyr/blob/98580f1c22481c200db2f37881e9c5161f2bd35f/subsys/net/ip/net_if.c#L2756-L2774



However the other usages in `handle_ra_input` do check for a nullptr:

- `net_if_ipv6_get_reachable_time`:

  ```c
  if (!iface->config.ip.ipv6) { return 0; }
  ```

  https://github.com/zephyrproject-rtos/zephyr/blob/98580f1c22481c200db2f37881e9c5161f2bd35f/include/zephyr/net/net_if.h#L1395-L1413

- `net_if_ipv6_set_base_reachable_time`

  ```c
  if (!iface->config.ip.ipv6) { return; }
  ```

  https://github.com/zephyrproject-rtos/zephyr/blob/98580f1c22481c200db2f37881e9c5161f2bd35f/include/zephyr/net/net_if.h#L1377-L1393

## Impact

- Potentially cause a Denial of Service.
  - Note: We are able to cause a DoS in Zephyr 2.2.0 with fuzzing, but did not try to reproduce in current versions.


## Proposed Fix

- Add a nullptr check in `net_if_ipv6_set_reachable_time` or add a wrapper function with a check similar to `net_if_ipv6_get_reachable_time` or `net_if_ipv6_set_base_reachable_time`.